# FluxHero Docker Environment Configuration
# ==========================================
# Copy this file to the project root as .env before running docker compose
#
# Usage:
#   cp docker/.env.docker.example .env
#   # Edit .env with your values
#   docker compose up -d
#
# IMPORTANT: Never commit your .env file with real credentials!

# ============================================================================
# REQUIRED: Authentication
# ============================================================================

# Secret key for API and WebSocket authentication
# CRITICAL: Change this to a secure random value in production!
# Generate with: python -c "import secrets; print(secrets.token_urlsafe(32))"
FLUXHERO_AUTH_SECRET=fluxhero-dev-secret-change-in-production

# ============================================================================
# REQUIRED: Security (Broker Credential Encryption)
# ============================================================================

# AES-256 encryption key for broker credentials
# CRITICAL: Required for storing broker API keys securely
# Generate with: python -c "import secrets; print(secrets.token_hex(32))"
FLUXHERO_ENCRYPTION_KEY=

# ============================================================================
# REQUIRED: Alpaca API Configuration
# ============================================================================

# Alpaca API endpoints
# For paper trading (recommended for testing):
FLUXHERO_ALPACA_API_URL=https://paper-api.alpaca.markets
# For live trading (use with caution):
# FLUXHERO_ALPACA_API_URL=https://api.alpaca.markets

# WebSocket URL for market data
FLUXHERO_ALPACA_WS_URL=wss://stream.data.alpaca.markets

# Alpaca credentials (get from https://app.alpaca.markets/)
FLUXHERO_ALPACA_API_KEY=your_api_key_here
FLUXHERO_ALPACA_API_SECRET=your_api_secret_here

# ============================================================================
# Docker Container Paths (DO NOT CHANGE)
# ============================================================================
# These paths are configured for Docker volume mounts.
# The docker-compose.yml maps:
#   ./data -> /app/data (SQLite DB and parquet cache)
#   ./logs -> /app/logs (application logs)

FLUXHERO_CACHE_DIR=/app/data/cache
FLUXHERO_LOG_FILE=/app/logs/fluxhero.log

# ============================================================================
# API Configuration
# ============================================================================

FLUXHERO_API_TITLE=FluxHero API
FLUXHERO_API_DESCRIPTION=REST API for FluxHero adaptive quant trading system
FLUXHERO_API_VERSION=1.0.0

# ============================================================================
# CORS Configuration
# ============================================================================

# Allowed CORS origins (JSON array format)
# For Docker, include both service names and localhost for development
FLUXHERO_CORS_ORIGINS=["http://localhost:3000","http://frontend:3000","http://127.0.0.1:3000"]

FLUXHERO_CORS_ALLOW_CREDENTIALS=true
FLUXHERO_CORS_ALLOW_METHODS=["*"]
FLUXHERO_CORS_ALLOW_HEADERS=["*"]

# ============================================================================
# Risk Management Configuration
# ============================================================================

# Position-level limits
# Maximum risk per position for trend-following strategies (default: 1%)
FLUXHERO_MAX_RISK_PCT_TREND=0.01
# Maximum risk per position for mean reversion strategies (default: 0.75%)
FLUXHERO_MAX_RISK_PCT_MEAN_REV=0.0075
# Maximum position size as percentage of account (default: 20%)
FLUXHERO_MAX_POSITION_SIZE_PCT=0.20

# Portfolio-level limits
# Maximum total portfolio exposure (default: 50%)
FLUXHERO_MAX_TOTAL_EXPOSURE_PCT=0.50
# Maximum number of open positions (default: 5)
FLUXHERO_MAX_OPEN_POSITIONS=5
# Correlation threshold for position size reduction (default: 0.7)
FLUXHERO_CORRELATION_THRESHOLD=0.7
# Position size reduction when correlation exceeds threshold (default: 50%)
FLUXHERO_CORRELATION_SIZE_REDUCTION=0.50

# Stop loss settings
# ATR multiplier for trend-following stop losses (default: 2.5)
FLUXHERO_TREND_STOP_ATR_MULTIPLIER=2.5
# Fixed stop loss percentage for mean reversion (default: 3%)
FLUXHERO_MEAN_REV_STOP_PCT=0.03

# ============================================================================
# Paper Trading Configuration
# ============================================================================

# Slippage simulation in basis points (5 bps = 0.05%)
FLUXHERO_PAPER_SLIPPAGE_BPS=5.0
# Initial paper trading account balance in USD
FLUXHERO_PAPER_INITIAL_BALANCE=100000.0
# Fallback mock price when market data unavailable
FLUXHERO_PAPER_MOCK_PRICE=100.0
# Price cache TTL in seconds
FLUXHERO_PAPER_PRICE_CACHE_TTL=60.0

# ============================================================================
# Market Data Configuration
# ============================================================================

# Default timeframe for market data
FLUXHERO_DEFAULT_TIMEFRAME=1h
# Number of initial candles to fetch on startup
FLUXHERO_INITIAL_CANDLES=500

# ============================================================================
# Frontend Configuration (set in docker-compose.yml environment)
# ============================================================================
# These are typically set directly in docker-compose.yml but documented here:
#
# NEXT_PUBLIC_API_URL=http://backend:8000
#   - URL for frontend to reach backend API via Docker network
#   - Uses Docker service name 'backend' for internal communication
#
# NEXT_PUBLIC_WS_URL=ws://backend:8000
#   - WebSocket URL for real-time updates via Docker network
